<!--
	NOTES:
	1. All tokens are represented by '$' sign in the template.
	2. You can write your code only wherever mentioned.
	3. "DO NOT" alter the tokens in the template html as they are required during publishing.
-->

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>保卫萝卜</title>
<!-- write your code here -->


<!-- <script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script> -->
<script src="createjs-2015.11.26.min.js"></script>


<!-- write your code here -->
<style>
#mainView{
display:block;
margin:0 auto;
}
</style>
</head>
<body style="background-color:#D4D4D4;margin:0px;">
	<!-- <canvas id="mainView" width="800" height="1300" style="background-color:#FFFFFF"></canvas> -->
	<canvas id="mainView" width="800" height="1300" style="background-color:#FFFFFF"></canvas>
	
	
<script src="main.js"></script>
<script src="lb.js"></script>
<script>
var canvas, stage, exportRoot;
/*function init() {

	
	canvas = document.getElementById("canvas");
	images = images||{};
	ss = ss||{};

	var loader = new createjs.LoadQueue(false);
	loader.addEventListener("fileload", handleFileLoad);
	loader.addEventListener("complete", handleComplete);
	loader.loadFile({src:"images/保卫萝卜_atlas_.json", type:"spritesheet", id:"保卫萝卜_atlas_"}, true);
	loader.loadManifest(lib.properties.manifest);
}

function handleFileLoad(evt) {
	if (evt.item.type == "image") { images[evt.item.id] = evt.result; }
}*/

function handleComplete(evt) {
	var queue = evt.target;
	ss["保卫萝卜_atlas_"] = queue.getResult("保卫萝卜_atlas_");
	console.log(ss["保卫萝卜_atlas_"])
	exportRoot = new lib.保卫萝卜();

	stage = new createjs.Stage(mainView);
	stage.addChild(exportRoot);
	stage.update();

	createjs.Ticker.setFPS(lib.properties.fps);
	createjs.Ticker.addEventListener("tick", stage);
}


var xxx  = new Adaptation(def); //实例化

window.onload = function (){
	
	xxx.init()
	.touchstart(function(e){
		console.log('touchstart',e);
	})
	.touchmove(function(e){
		
	})
	.touchend(function(e){
		console.log('touchend',e);
	})
	.mousedown(function(e){
		console.log('mousedown');
	})
	.mousemove(function(e){
		console.log('mousemove');
	})
	.mouseup(function(e){
		console.log('mouseup');
	})
	
	.callback(function(){
		//console.log('callback...');
	});
	console.log(xxx);
}



function A (){
	this.name = 'MY NAME IS A.'
}

A.prototype = new createjs.LoadQueue(true);
//A.prototype.constructor = A;

function Create(){
	
	//var load = new createjs.LoadQueue(true);
	//console.log(load)
	
	/*
	直接在方法上进行扩展
	缺点:不灵活
	createjs.LoadQueue.prototype.getName = function (){
		return this.name;
	}*/
	//a.getName.bind(load);
	//load.prototype = A.prototype;
	//load.getName();
	//console.log('a.prototype:',a.prototype)
	//console.log('load.prototype:',load.prototype);
	
	//a.prototype = load.prototype;
	//a.prototype = new createjs.LoadQueue(true);
	
	//a.prototype.constructor = a;
	//-------
	//console.log('a:',a)
	
	//a.load()
	
	//return a;
}


/*var a = new A();
a.loadFile({src:"images/保卫萝卜_atlas_.json", type:"spritesheet", id:"保卫萝卜_atlas_"}, true);
a.load()
console.log('a:',a)
*/
function loader (option){
	this.loader = null;
	this.loadFileDate = null;
	//this.loadFile = function (e){};
	//
	this._loadFile = function (e){}      //加载文件清单
	this._fileload = function (e){}      //单个文件已完成加载。
	this._fileprogress = function (e){}  //单个文件进度变化。注意,只有文件装载XHR(或可能通过插件)将 file 事件进展除了0或100%。
	this._progress = function (e){}      //对于整个队列进展已经改变。
	this._error = function (e){}         //当队列与任何文件遇到错误时。
	this._complete = function (e){}      //当队列完成加载所有文件时。
	
	this._arguments = [];
	
	//
	/* for (var i in arguments) {
        console.log('arguments:',arguments[i]);
    }*/
	
	this._arguments = Array.prototype.slice.call(arguments);
	
	console.log('_arguments:',this._arguments);
	
	//return this.init();
}

loader.prototype = new createjs.LoadQueue(true);

loader.prototype._init = function (o){
	var _this = this;
	//console.log('arguments:',arguments)
	
	try{
		this.loader = new createjs.LoadQueue(true);
		console.log('队列初始化-绑定事件');
		
		
		this.loader.addEventListener("fileload", function(evt){
			_this._fileload(evt)
		});
		
		this.loader.addEventListener("progress", function(evt){
			 _this._progress(evt)
		});
		
		this.loader.addEventListener("fileprogress", function(evt){
			 _this._fileprogress(evt)
		});
		
		this.loader.addEventListener("complete", function(evt){
		    console.log('complete:',evt);
			_this._complete(evt,_this.loader)
		} );
		
		this.loader.addEventListener("error",  function(evt){
			_this._error(evt)
		});
		
		
		//console.log('this:',this.loader)
		
		this.loader.loadFile({src:"images/保卫萝卜_atlas_.json", type:"spritesheet", id:"保卫萝卜_atlas_"}, true);//new add software create
	
		//this.loader.loadFile.call(this._arguments)
		
		this.loader.load() ;//执行加载
		//this._loadFile = this.loader.loadFile;
		//console.log('this.loadFile:',this.loadFile)
		//console.log('_this.loadFile:',this._loadFile)
		//this.prototype =  new createjs.LoadQueue(true);
	}catch(e){
		console.warn('Preload.js 未加载')
	}
	
	return this;
}
//loader.prototype.loadFile = 
loader.prototype.AAAAAAA = function (){
	
} 

loader.prototype.fileload = function (fn){
	if(fn && typeof fn === 'function'){
		this._fileload = fn;
	}
	return this;
}
loader.prototype.fileprogress = function (fn){
	if(fn && typeof fn === 'function'){
		this._fileprogress = fn;
	}
	return this;
}
loader.prototype.progress = function (fn){
	if(fn && typeof fn === 'function'){
		this._progress = fn;
	}	
	return this;
}
loader.prototype.complete = function (fn){
	if(fn && typeof fn === 'function'){
		this._complete = fn;
	}
	return this;
}
loader.prototype.error = loader.prototype.catch = function (fn){
	if(fn && typeof fn === 'function'){
		this._error = fn;
	}
}



//var lll = new loader({id:"image", src:"filePath/file.jpg"});
//var lll = new loader([]);
var load = new loader({src:"images/保卫萝卜_atlas_.json", type:"spritesheet", id:"保卫萝卜_atlas_"}, true);
load._init();
console.log(load);

	//load.loadFile("images/hear.png")
	//load.loader.loadFile({src:"images/保卫萝卜_atlas_.json", type:"spritesheet", id:"保卫萝卜_atlas_"}, true);//new add software create
	//load.loadFile({src:"images/保卫萝卜_atlas_.json", type:"spritesheet", id:"保卫萝卜_atlas_"}, true);//new add software create

	
	
	/*load
	.fileload(function(evt){
		console.log(evt)
	})
	.fileprogress(function(evt){
		console.log(evt)
	})
	.progress(function(evt){
		console.log(evt)
	})
	.complete(function(evt,queue){
		console.log('complete:',evt)
		console.log(evt.target === queue)
	})
	.error(function(evt){
		console.log(evt)
	})
	//.catch(function(){})
	*/
	//load.load();

</script>
</body>
</html>
